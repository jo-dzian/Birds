

setwd ("D:/Ptaki_hydro/Obliczenia/R/IHA")

Q_mod <- data.frame( read.csv("Q_modelled.csv"))

#island locations paired with subbasins
island_reach <- data.frame( read.csv("wyspa_subbasin.csv"))

#Narrow down the Q data to subbasins with islands
Q_mod_Wisla <- Q_mod[Q_mod$RCH %in% island_reach$Subbasin, ] #there are 19 subbasins as 3 describe double bird islands

#write.csv(Q_mod_Wisla, "Q_mod_Wisla.csv")
#Q_mod_Wisla <- data.frame( read.csv("Q_mod_Wisla.csv"))

#because data was read from a csv file the dates were converted to factor, now they need to be converted to date again
Q_mod_Wisla$date <- as.Date(Q_mod_Wisla$mdate, format="%Y-%m-%d")


#yyyy-mm-dd
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

# Setting the order of RCH for display 
ord_table_m <- table(Q_mod_Wisla$RCH)
ord_levels_m <- names(ord_table_m)[order(ord_table_m)]
Q_mod_Wisla$RCH2 <- factor(Q_mod_Wisla$RCH, levels = ord_levels_m)

#Narrowing the data to vulnerability period for Śmieszka : 11.04 - 10.06
#black-headed gull #Śmieszka #(Chroicocephalus ridibundus)
Smieszka2004 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2004-04-11" & Q_mod_Wisla$date <= "2004-06-10") 
Smieszka2005 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2005-04-11" & Q_mod_Wisla$date <= "2005-06-10")
Smieszka2006 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2006-04-11" & Q_mod_Wisla$date <= "2006-06-10")
Smieszka2007 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2007-04-11" & Q_mod_Wisla$date <= "2007-06-10")
Smieszka2008 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2008-04-11" & Q_mod_Wisla$date <= "2008-06-10")
Smieszka2009 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2009-04-11" & Q_mod_Wisla$date <= "2009-06-10")
Smieszka2010 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2010-04-11" & Q_mod_Wisla$date <= "2010-06-10")
Smieszka2011 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2011-04-11" & Q_mod_Wisla$date <= "2011-06-10")
Smieszka2012 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2012-04-11" & Q_mod_Wisla$date <= "2012-06-10")
Smieszka2013 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2013-04-11" & Q_mod_Wisla$date <= "2013-06-10")
Smieszka2014 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2014-04-11" & Q_mod_Wisla$date <= "2014-06-10")
Smieszka2015 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2015-04-11" & Q_mod_Wisla$date <= "2015-06-10")
Smieszka2016 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2016-04-11" & Q_mod_Wisla$date <= "2016-06-10")
Smieszka2017 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2017-04-11" & Q_mod_Wisla$date <= "2017-06-10")
Smieszka2018 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2018-04-11" & Q_mod_Wisla$date <= "2018-06-10")

Smieszka_Q <- rbind(Smieszka2004,Smieszka2005,Smieszka2006,Smieszka2007,Smieszka2008,Smieszka2009,
                    Smieszka2010,Smieszka2011,Smieszka2012,Smieszka2013,Smieszka2014,Smieszka2015,
                    Smieszka2016,Smieszka2017,Smieszka2018)

Smieszka_Q$Year <- format(as.Date(Smieszka_Q$date, format="%Y-%m-%d"),"%Y")

Smieszka_list <- list(Smieszka2004,Smieszka2005,Smieszka2006,Smieszka2007,Smieszka2008,Smieszka2009,Smieszka2010,
                  Smieszka2011, Smieszka2012, Smieszka2013, Smieszka2014,Smieszka2015,Smieszka2016,Smieszka2017,
                    Smieszka2018)

#write.csv(Smieszka_Q, "Smieszka_Q.csv")

Smieszka_Q <- read.csv("D:/Ptaki_hydro/Obliczenia/R/Birds/Smieszka_Q.csv")

#black-headed gull #Śmieszka #(Chroicocephalus ridibundus)

b_gull <- data.frame( read.csv("D:/Ptaki_hydro/Obliczenia/R/Birds/b_gull_na.csv")) %>%
  remove_rownames %>% column_to_rownames(var="X")

# works with selecting 11 April every year
#smieszka <- subset(Q_mod_Wisla, format.Date(Q_mod_Wisla$date, "%m")=="04" & format.Date(date, "%d")=="11")

#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#Narrowing the data to vulnerability period for Mewa Siwa : 21.04 - 30.06
#common gull #mewa siwa #(Larus canus)
Mewa2004 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2004-04-21" & Q_mod_Wisla$date <= "2004-06-30") 
Mewa2005 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2005-04-21" & Q_mod_Wisla$date <= "2005-06-30")
Mewa2006 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2006-04-21" & Q_mod_Wisla$date <= "2006-06-30")
Mewa2007 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2007-04-21" & Q_mod_Wisla$date <= "2007-06-30")
Mewa2008 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2008-04-21" & Q_mod_Wisla$date <= "2008-06-30")
Mewa2009 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2009-04-21" & Q_mod_Wisla$date <= "2009-06-30")
Mewa2010 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2010-04-21" & Q_mod_Wisla$date <= "2010-06-30")
Mewa2011 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2011-04-21" & Q_mod_Wisla$date <= "2011-06-30")
Mewa2012 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2012-04-21" & Q_mod_Wisla$date <= "2012-06-30")
Mewa2013 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2013-04-21" & Q_mod_Wisla$date <= "2013-06-30")
Mewa2014 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2014-04-21" & Q_mod_Wisla$date <= "2014-06-30")
Mewa2015 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2015-04-21" & Q_mod_Wisla$date <= "2015-06-30")
Mewa2016 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2016-04-21" & Q_mod_Wisla$date <= "2016-06-30")
Mewa2017 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2017-04-21" & Q_mod_Wisla$date <= "2017-06-30")
Mewa2018 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2018-04-21" & Q_mod_Wisla$date <= "2018-06-30")

Mewa_Q <- rbind(Mewa2004,Mewa2005,Mewa2006,Mewa2007,Mewa2008,Mewa2009,Mewa2010,Mewa2011,Mewa2012,Mewa2013,
                Mewa2014,Mewa2015,Mewa2016,Mewa2017,Mewa2018)

#write.csv(Mewa_Q, "Mewa_siwa_Q.csv")

Mewa_Q <- read.csv("D:/Ptaki_hydro/Obliczenia/R/Birds/Mewa_siwa_Q.csv")

#common gull #mewa siwa #(Larus canus)

c_gull <- data.frame( read.csv("D:/Ptaki_hydro/Obliczenia/R/Birds/c_gull.csv"))%>%
  remove_rownames %>% column_to_rownames(var="X")


#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#Narrowing the data to vulnerability period for Rybitwa białoczelna : 11.05 - 10.07
#little tern #rybitwa białoczelna #(Sternula albifrons)
Rybitwa2004 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2004-05-11" & Q_mod_Wisla$date <= "2004-07-10") 
Rybitwa2005 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2005-05-11" & Q_mod_Wisla$date <= "2005-07-10")
Rybitwa2006 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2006-05-11" & Q_mod_Wisla$date <= "2006-07-10")
Rybitwa2007 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2007-05-11" & Q_mod_Wisla$date <= "2007-07-10")
Rybitwa2008 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2008-05-11" & Q_mod_Wisla$date <= "2008-07-10")
Rybitwa2009 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2009-05-11" & Q_mod_Wisla$date <= "2009-07-10")
Rybitwa2010 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2010-05-11" & Q_mod_Wisla$date <= "2010-07-10")
Rybitwa2011 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2011-05-11" & Q_mod_Wisla$date <= "2011-07-10")
Rybitwa2012 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2012-05-11" & Q_mod_Wisla$date <= "2012-07-10")
Rybitwa2013 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2013-05-11" & Q_mod_Wisla$date <= "2013-07-10")
Rybitwa2014 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2014-05-11" & Q_mod_Wisla$date <= "2014-07-10")
Rybitwa2015 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2015-05-11" & Q_mod_Wisla$date <= "2015-07-10")
Rybitwa2016 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2016-05-11" & Q_mod_Wisla$date <= "2016-07-10")
Rybitwa2017 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2017-05-11" & Q_mod_Wisla$date <= "2017-07-10")
Rybitwa2018 <- Q_mod_Wisla %>% filter(Q_mod_Wisla$date>="2018-05-11" & Q_mod_Wisla$date <= "2018-07-10")

Rybitwa_Q <- rbind(Rybitwa2004,Rybitwa2005,Rybitwa2006,Rybitwa2007,Rybitwa2008,Rybitwa2009,Rybitwa2010,
                   Rybitwa2011,Rybitwa2012,Rybitwa2013,Rybitwa2014,Rybitwa2015,Rybitwa2016,Rybitwa2017,Rybitwa2018)

#write.csv(Rybitwa_Q, "Rybitwa_Q.csv")
Rybitwa_Q <- read.csv("D:/Ptaki_hydro/Obliczenia/R/Birds/Rybitwa_Q.csv")


#little tern #rybitwa białoczelna #(Sternula albifrons)
tern <- data.frame( read.csv("D:/Ptaki_hydro/Obliczenia/R/Birds/tern_na.csv"))%>% 
  remove_rownames %>% column_to_rownames(var="X")


#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
###### OBSERVED Q 
###### OBSERVED Q 
###### OBSERVED Q FOR Vulnerability period

# Setting the order of RCH for display, this links to code hydro_stations.R
ord_table <- table(obs_Wisla$RCH)
ord_levels <- names(ord_table)[order(ord_table)]
obs_Wisla$RCH2 <- factor(obs_Wisla$RCH, levels = ord_levels)

#Narrowing the data to vulnerability period for Śmieszka : 11.04 - 10.06
Smieszka2004_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2004-04-11" & obs_Wisla$date <= "2004-06-10") 
Smieszka2005_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2005-04-11" & obs_Wisla$date <= "2005-06-10")
Smieszka2006_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2006-04-11" & obs_Wisla$date <= "2006-06-10")
Smieszka2007_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2007-04-11" & obs_Wisla$date <= "2007-06-10")
Smieszka2008_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2008-04-11" & obs_Wisla$date <= "2008-06-10")
Smieszka2009_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2009-04-11" & obs_Wisla$date <= "2009-06-10")
Smieszka2010_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2010-04-11" & obs_Wisla$date <= "2010-06-10")
Smieszka2011_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2011-04-11" & obs_Wisla$date <= "2011-06-10")
Smieszka2012_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2012-04-11" & obs_Wisla$date <= "2012-06-10")
Smieszka2013_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2013-04-11" & obs_Wisla$date <= "2013-06-10")
Smieszka2014_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2014-04-11" & obs_Wisla$date <= "2014-06-10")
Smieszka2015_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2015-04-11" & obs_Wisla$date <= "2015-06-10")
Smieszka2016_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2016-04-11" & obs_Wisla$date <= "2016-06-10")
Smieszka2017_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2017-04-11" & obs_Wisla$date <= "2017-06-10")
Smieszka2018_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2018-04-11" & obs_Wisla$date <= "2018-06-10")

Smieszka_Q_obs <- rbind(Smieszka2004_obs,Smieszka2005_obs,Smieszka2006_obs,Smieszka2007_obs,Smieszka2008_obs,Smieszka2009_obs,
                    Smieszka2010_obs,Smieszka2011_obs,Smieszka2012_obs,Smieszka2013_obs,Smieszka2014_obs,Smieszka2015_obs,
                    Smieszka2016_obs,Smieszka2017_obs,Smieszka2018_obs)

Smieszka_obs_list <- list(Smieszka2004_obs,Smieszka2005_obs,Smieszka2006_obs,Smieszka2007_obs,Smieszka2008_obs,Smieszka2009_obs,Smieszka2010_obs,
                      Smieszka2011_obs, Smieszka2012_obs, Smieszka2013_obs, Smieszka2014_obs,Smieszka2015_obs,Smieszka2016_obs,Smieszka2017_obs,
                      Smieszka2018_obs)

#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#Narrowing the data to vulnerability period for Mewa Siwa : 21.04 - 30.06
Mewa2004_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2004-04-21" & obs_Wisla$date <= "2004-06-30") 
Mewa2005_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2005-04-21" & obs_Wisla$date <= "2005-06-30")
Mewa2006_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2006-04-21" & obs_Wisla$date <= "2006-06-30")
Mewa2007_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2007-04-21" & obs_Wisla$date <= "2007-06-30")
Mewa2008_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2008-04-21" & obs_Wisla$date <= "2008-06-30")
Mewa2009_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2009-04-21" & obs_Wisla$date <= "2009-06-30")
Mewa2010_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2010-04-21" & obs_Wisla$date <= "2010-06-30")
Mewa2011_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2011-04-21" & obs_Wisla$date <= "2011-06-30")
Mewa2012_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2012-04-21" & obs_Wisla$date <= "2012-06-30")
Mewa2013_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2013-04-21" & obs_Wisla$date <= "2013-06-30")
Mewa2014_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2014-04-21" & obs_Wisla$date <= "2014-06-30")
Mewa2015_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2015-04-21" & obs_Wisla$date <= "2015-06-30")
Mewa2016_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2016-04-21" & obs_Wisla$date <= "2016-06-30")
Mewa2017_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2017-04-21" & obs_Wisla$date <= "2017-06-30")
Mewa2018_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2018-04-21" & obs_Wisla$date <= "2018-06-30")

Mewa_Q_obs <- rbind(Mewa2004_obs,Mewa2005_obs,Mewa2006_obs,Mewa2007_obs,Mewa2008_obs,Mewa2009_obs,Mewa2010_obs,
                    Mewa2011_obs,Mewa2012_obs,Mewa2013_obs,Mewa2014_obs,Mewa2015_obs,Mewa2016_obs,Mewa2017_obs,
                    Mewa2018_obs)

Mewa_obs_list <- list(Mewa2004_obs,Mewa2005_obs,Mewa2006_obs,Mewa2007_obs,Mewa2008_obs,Mewa2009_obs,Mewa2010_obs,
                    Mewa2011_obs,Mewa2012_obs,Mewa2013_obs,Mewa2014_obs,Mewa2015_obs,Mewa2016_obs,Mewa2017_obs,
                    Mewa2018_obs)
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#Narrowing the data to vulnerability period for Rybitwa białoczelna : 11.05 - 10.07
Rybitwa2004_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2004-05-11" & obs_Wisla$date <= "2004-07-10") 
Rybitwa2005_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2005-05-11" & obs_Wisla$date <= "2005-07-10")
Rybitwa2006_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2006-05-11" & obs_Wisla$date <= "2006-07-10")
Rybitwa2007_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2007-05-11" & obs_Wisla$date <= "2007-07-10")
Rybitwa2008_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2008-05-11" & obs_Wisla$date <= "2008-07-10")
Rybitwa2009_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2009-05-11" & obs_Wisla$date <= "2009-07-10")
Rybitwa2010_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2010-05-11" & obs_Wisla$date <= "2010-07-10")
Rybitwa2011_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2011-05-11" & obs_Wisla$date <= "2011-07-10")
Rybitwa2012_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2012-05-11" & obs_Wisla$date <= "2012-07-10")
Rybitwa2013_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2013-05-11" & obs_Wisla$date <= "2013-07-10")
Rybitwa2014_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2014-05-11" & obs_Wisla$date <= "2014-07-10")
Rybitwa2015_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2015-05-11" & obs_Wisla$date <= "2015-07-10")
Rybitwa2016_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2016-05-11" & obs_Wisla$date <= "2016-07-10")
Rybitwa2017_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2017-05-11" & obs_Wisla$date <= "2017-07-10")
Rybitwa2018_obs <- obs_Wisla %>% filter(obs_Wisla$date>="2018-05-11" & obs_Wisla$date <= "2018-07-10")

Rybitwa_Q_obs <- rbind(Rybitwa2004_obs,Rybitwa2005_obs,Rybitwa2006_obs,Rybitwa2007_obs,Rybitwa2008_obs,Rybitwa2009_obs,
                   Rybitwa2010_obs,Rybitwa2011_obs,Rybitwa2012_obs,Rybitwa2013_obs,Rybitwa2014_obs,Rybitwa2015_obs,
                   Rybitwa2016_obs,Rybitwa2017_obs,Rybitwa2018_obs)

Rybitwa_obs_list <- list(Rybitwa2004_obs,Rybitwa2005_obs,Rybitwa2006_obs,Rybitwa2007_obs,Rybitwa2008_obs,Rybitwa2009_obs,
                       Rybitwa2010_obs,Rybitwa2011_obs,Rybitwa2012_obs,Rybitwa2013_obs,Rybitwa2014_obs,Rybitwa2015_obs,
                       Rybitwa2016_obs,Rybitwa2017_obs,Rybitwa2018_obs)
